fragment StorageBucketIds on StorageBucket {
  id
}

query getStorageBuckets {
  storageBuckets(
    where: {
      operatorStatus: { isTypeOf_eq: "StorageBucketOperatorStatusActive" }
      operatorMetadata: {
        OR: [
          { nodeOperationalStatus_isNull: true }
          { nodeOperationalStatus: { isTypeOf_eq: "NodeOperationalStatusNormal" } }
        ]
      }
    }
  ) {
    ...StorageBucketIds
  }
}

query getStorageBucketsByWorkerId($workerId: BigInt!) {
  storageBuckets(
    where: {
      operatorStatus: { isTypeOf_eq: "StorageBucketOperatorStatusActive", workerId_eq: $workerId }
      operatorMetadata: {
        OR: [
          { nodeOperationalStatus_isNull: true }
          { nodeOperationalStatus: { isTypeOf_eq: "NodeOperationalStatusNormal" } }
        ]
      }
    }
  ) {
    ...StorageBucketIds
  }
}

query getStorageBucketsOperationalStatus($ids: [String!]) {
  storageBuckets(where: { id_in: $ids }) {
    id
    operatorMetadata {
      nodeOperationalStatus {
        ... on NodeOperationalStatusNormal {
          __typename
        }
        ... on NodeOperationalStatusNoService {
          __typename
          forced
        }
        ... on NodeOperationalStatusNoServiceFrom {
          __typename
          forced
        }
        ... on NodeOperationalStatusNoServiceDuring {
          __typename
          forced
        }
      }
    }
  }
}

fragment StorageBucketDetails on StorageBucket {
  id
  operatorMetadata {
    id
    nodeEndpoint
  }
  operatorStatus {
    ... on StorageBucketOperatorStatusActive {
      workerId
    }
    ... on StorageBucketOperatorStatusInvited {
      workerId
    }
  }
}

query getStorageBucketDetails($ids: [String!]) {
  storageBuckets(where: { id_in: $ids }) {
    ...StorageBucketDetails
  }
}

fragment StorageBagDetails on StorageBag {
  id
  storageBuckets {
    storageBucket {
      id
    }
  }
}

query getStorageBagDetails($bucketIds: [String!]) {
  storageBags(where: { storageBuckets_some: { storageBucket: { id_in: $bucketIds } } }) {
    ...StorageBagDetails
  }
}

fragment DataObjectByBagIdsDetails on StorageDataObject {
  id
  ipfsHash
  storageBag {
    id
  }
}

query getDataObjectsByBagIds($bagIds: StorageBagWhereInput) {
  storageDataObjects(where: { storageBag: $bagIds, isAccepted_eq: true }) {
    ...DataObjectByBagIdsDetails
  }
}

fragment DataObjectDetails on StorageDataObject {
  id
  isAccepted
  ipfsHash
  storageBag {
    ...StorageBagDetails
  }
}

query getDataObjects($dataObjectIds: [String!]) {
  storageDataObjects(where: { id_in: $dataObjectIds }) {
    ...DataObjectDetails
  }
}

query getDataObjectsDeletedEvents($dataObjectIds: [String!]) {
  events(where: { data: { isTypeOf_eq: "DataObjectDeletedEventData", dataObjectId_in: $dataObjectIds } }) {
    data {
      ... on DataObjectDeletedEventData {
        dataObjectId
      }
    }
  }
}

fragment SquidVersionFields on SquidVersion {
  version
}

query getSquidVersion {
  squidVersion {
    ...SquidVersionFields
  }
}

fragment SquidStatusFields on SquidStatus {
  height
}

query squidStatus {
  squidStatus {
    ...SquidStatusFields
  }
}
